generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id           String        @id @default(uuid())
  name         String
  email        String        @unique
  password     String
  applications Application[]
  interviews   Interview[]
}

model Recruiter {
  id       String    @id @default(uuid())
  name     String
  email    String    @unique
  password String
  jobPosts JobPost[]
}

model JobPost {
  id             String        @id @default(uuid())
  title          String
  jobDescription String
  skills         String[]
  experience     Int
  minScore       Int
  applications   Application[]
  interviews     Interview[]
  open           Boolean       @default(true)
  recruiterId    String
  recruiter      Recruiter     @relation(fields: [recruiterId], references: [id])
}

enum Status {
  Applied
  rejected
  shortlisted_for_interview
  shortlisted
}

model Application {
  id             String      @id @default(uuid())
  userId         String
  jobPostId      String
  resumeText     String
  screeningScore Int
  feedback       String
  status         Status      @default(Applied)
  interviewed    Boolean     @default(false)
  user           User        @relation(fields: [userId], references: [id])
  jobPost        JobPost     @relation(fields: [jobPostId], references: [id])
  interviews     Interview[]

  @@unique([userId, jobPostId])
}

model Interview {
  id                String      @id @default(uuid())
  userId            String
  applicationId     String
  jobPostId         String
  performanceReview String?
  performanceScore  Int?
  transcript        Json?
  user              User        @relation(fields: [userId], references: [id])
  jobPost           JobPost     @relation(fields: [jobPostId], references: [id])
  application       Application @relation(fields: [applicationId], references: [id])

  @@unique([userId, applicationId, jobPostId])
}
